QVariant MyPolygonItem::itemChange(QGraphicsItem::GraphicsItemChange change, const QVariant& value) {
    if (change == ItemPositionChange && scene()) {
        QPointF newPos = value.toPointF();
        QRectF rect = scene()->sceneRect();
        QPointF labelPos = m_label->pos();
        rect.translate(-labelPos.x(), -labelPos.y());
        if (!rect.contains(newPos)) {
            newPos.setX(qMin(rect.right(), qMax(newPos.x(), rect.left())));
            newPos.setY(qMin(rect.bottom(), qMax(newPos.y(), rect.top())));
            m_label->setPos(newPos);
        }
    }
    return QGraphicsPolygonItem::itemChange(change, value);
}




QPainterPath MyPolygonItem::shape() const {
    QPainterPath path = QGraphicsPolygonItem::shape();
    path.addRect(m_label->sceneBoundingRect());
    return path;
}
